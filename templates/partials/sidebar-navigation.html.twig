{% macro loop(page, parent_loop) %}
    {% if parent_loop|length > 0 %}
        {% set data_level = parent_loop %}
        {% set parent_loop = parent_loop ~ '.' %}
    {% else %}
        {% set data_level = 0 %}
    {% endif %}
    {% for p in page.children %}
        {% if p.visible %}
            <li class="dd-item" data-nav-level='{{ data_level }}' data-nav-id="{{ p.route }}">
                <a href="{{ p.url }}">
                    <i class="read-icon icon-check"></i>
                    <i class="bookmark-icon icon-star"></i>
                    <span>
                    <b>{{ parent_loop}}{{ loop.index }}.</b> {{ p.menu }}
                </span>
                </a>
                {% if p.children.count > 0 %}
                    <ul>
                        {{ _self.loop(p, parent_loop~loop.index) }}
                    </ul>
                {% endif %}
            </li>
        {% endif %}
    {% endfor %}
{% endmacro %}

{% macro loop(page, parent_loop) %}
    {% if parent_loop|length > 0 %}
        <ul class="sidebar-nav-items">
            {% for p in page.children.visible %}
                {% set parent_page = p.activeChild ? ' parent' : '' %}
                {% set current_page = p.active ? ' active' : '' %}
                <li>
                    <a href="#{{ p.menu }}" class="sidebar-nav-item">
                        {{ p.menu }}
                    </a>
                    {% if p.children.count > 0 %}
                        {{ _self.loop(p, parent_loop + loop.index) }}
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <h5 class="sidebar-nav-heading">{{ page.menu }}</h5>
    {% endif %}
{% endmacro %}

<nav class="sidebar-nav">
    {{ _self.loop(pages, '') }}
</nav>